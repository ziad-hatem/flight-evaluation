(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[698],{5273:(e,a,r)=>{Promise.resolve().then(r.bind(r,7220))},5695:(e,a,r)=>{"use strict";var t=r(8999);r.o(t,"useParams")&&r.d(a,{useParams:function(){return t.useParams}}),r.o(t,"useRouter")&&r.d(a,{useRouter:function(){return t.useRouter}}),r.o(t,"useSearchParams")&&r.d(a,{useSearchParams:function(){return t.useSearchParams}})},7220:(e,a,r)=>{"use strict";r.r(a),r.d(a,{default:()=>n});var t=r(5155),i=r(2115),l=r(2108),s=r(5695);let d=e=>new Date(e).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"});function n(){let e=(0,s.useRouter)(),{data:a,status:r}=(0,l.useSession)(),[n,o]=(0,i.useState)("airlines"),[c,m]=(0,i.useState)({name:"",logo:"",description:""}),[x,u]=(0,i.useState)({flightNumber:"",origin:"",destination:"",departureTime:"",arrivalTime:"",airlineId:""}),[h,g]=(0,i.useState)([]),[p,b]=(0,i.useState)([]),[y,f]=(0,i.useState)(!1),[j,N]=(0,i.useState)(null),[v,k]=(0,i.useState)(null),[w,T]=(0,i.useState)(!1),[F,C]=(0,i.useState)(null),[S,A]=(0,i.useState)(null);(0,i.useEffect)(()=>{if("loading"!==r){if("unauthenticated"===r){e.push("/login?callbackUrl=/admin");return}D(),E()}},[r,e,a]);let D=async()=>{try{let e=await fetch("/api/airlines",{credentials:"include"});if(!e.ok)throw Error("Failed to fetch airlines");let a=await e.json();g(a)}catch(e){N("Failed to load airlines"),console.error(e)}},E=async()=>{try{let e=await fetch("/api/flights",{credentials:"include"});if(!e.ok)throw Error("Failed to fetch flights");let a=await e.json();b(a)}catch(e){N("Failed to load flights"),console.error(e)}},I=async e=>{e.preventDefault(),f(!0),N(null),k(null);try{let e="/api/airlines",a="POST",r="Airline created successfully";w&&F&&(e="/api/airlines/".concat(F),a="PUT",r="Airline updated successfully");let t=await fetch(e,{method:a,headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(c)}),i=await t.json();if(!t.ok)throw Error(i.error||"Failed to process airline");k(r),m({name:"",logo:"",description:""}),T(!1),C(null),D()}catch(e){N(e instanceof Error?e.message:"Failed to process airline")}finally{f(!1)}},P=async e=>{if(e.preventDefault(),f(!0),N(null),k(null),!x.flightNumber||!x.origin||!x.destination||!x.departureTime||!x.arrivalTime||!x.airlineId){N("All fields are required"),f(!1);return}let a=new Date(x.departureTime);if(new Date(x.arrivalTime)<=a){N("Arrival time must be after departure time"),f(!1);return}try{let e="/api/flights",a="POST",r="Flight created successfully";w&&F&&(e="/api/flights/".concat(F),a="PUT",r="Flight updated successfully");let t=await fetch(e,{method:a,headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(x)}),i=await t.json();if(!t.ok)throw Error(i.error||"Failed to process flight");k(r),u({flightNumber:"",origin:"",destination:"",departureTime:"",arrivalTime:"",airlineId:""}),T(!1),C(null),E()}catch(e){N(e instanceof Error?e.message:"Failed to process flight")}finally{f(!1)}};return y?(0,t.jsxs)("div",{className:"container mx-auto px-4 py-8 text-center",children:[(0,t.jsx)("div",{className:"inline-block h-8 w-8 animate-spin rounded-full border-4 border-solid border-blue-600 border-r-transparent"}),(0,t.jsx)("p",{className:"mt-2",children:"Loading..."})]}):(0,t.jsxs)("div",{className:"container mx-auto px-4 py-8",children:[(0,t.jsx)("h1",{className:"text-3xl font-bold mb-6",children:"Admin Dashboard"}),(0,t.jsxs)("div",{className:"flex space-x-4 mb-6",children:[(0,t.jsx)("button",{onClick:()=>o("airlines"),className:"px-4 py-2 rounded-lg ".concat("airlines"===n?"bg-blue-600 text-white":"bg-gray-200 text-gray-800 dark:bg-gray-700 dark:text-gray-300"),children:"Airlines"}),(0,t.jsx)("button",{onClick:()=>o("flights"),className:"px-4 py-2 rounded-lg ".concat("flights"===n?"bg-blue-600 text-white":"bg-gray-200 text-gray-800 dark:bg-gray-700 dark:text-gray-300"),children:"Flights"})]}),j&&(0,t.jsx)("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative mb-4",role:"alert",children:(0,t.jsx)("span",{className:"block sm:inline",children:j})}),v&&(0,t.jsx)("div",{className:"bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded relative mb-4",role:"alert",children:(0,t.jsx)("span",{className:"block sm:inline",children:v})}),"airlines"===n&&(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-md p-6",children:[(0,t.jsx)("h2",{className:"text-xl font-semibold mb-4",children:w?"Edit Airline":"Add New Airline"}),(0,t.jsxs)("form",{onSubmit:I,className:"space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"name",className:"block text-sm font-medium mb-1",children:"Airline Name"}),(0,t.jsx)("input",{type:"text",id:"name",name:"name",value:c.name,onChange:e=>m(a=>({...a,name:e.target.value})),className:"w-full p-2 border rounded-md dark:bg-gray-700 dark:border-gray-600",required:!0})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"logo",className:"block text-sm font-medium mb-1",children:"Logo URL"}),(0,t.jsx)("input",{type:"url",id:"logo",name:"logo",value:c.logo,onChange:e=>m(a=>({...a,logo:e.target.value})),className:"w-full p-2 border rounded-md dark:bg-gray-700 dark:border-gray-600"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"description",className:"block text-sm font-medium mb-1",children:"Description"}),(0,t.jsx)("textarea",{id:"description",name:"description",value:c.description,onChange:e=>m(a=>({...a,description:e.target.value})),className:"w-full p-2 border rounded-md dark:bg-gray-700 dark:border-gray-600",rows:3})]}),(0,t.jsxs)("div",{className:"flex space-x-2",children:[(0,t.jsx)("button",{type:"submit",className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors",disabled:y,children:w?"Update Airline":"Add Airline"}),w&&(0,t.jsx)("button",{type:"button",onClick:()=>{T(!1),C(null),m({name:"",logo:"",description:""})},className:"bg-gray-500 text-white px-4 py-2 rounded-lg hover:bg-gray-600 transition-colors",children:"Cancel"})]})]})]}),(0,t.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-md p-6",children:[(0,t.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Airlines List"}),(0,t.jsx)("div",{className:"overflow-x-auto",children:(0,t.jsxs)("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[(0,t.jsx)("thead",{className:"bg-gray-50 dark:bg-gray-700",children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Name"}),(0,t.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Logo"}),(0,t.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Description"}),(0,t.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Actions"})]})}),(0,t.jsx)("tbody",{className:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700",children:h.map(e=>(0,t.jsxs)("tr",{children:[(0,t.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:e.name}),(0,t.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:e.logo&&(0,t.jsx)("img",{src:e.logo,alt:e.name,className:"h-8 w-8 object-contain"})}),(0,t.jsx)("td",{className:"px-6 py-4",children:e.description}),(0,t.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,t.jsxs)("div",{className:"flex space-x-2",children:[(0,t.jsx)("button",{onClick:()=>{T(!0),C(e.id),m({name:e.name,logo:e.logo||"",description:e.description||""}),o("airlines"),window.scrollTo({top:0,behavior:"smooth"})},className:"text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300",children:"Edit"}),(0,t.jsx)("button",{onClick:()=>A({id:e.id,type:"airline"}),className:"text-red-600 hover:text-red-800 dark:text-red-400 dark:hover:text-red-300",children:"Delete"})]})})]},e.id))})]})})]})]}),"flights"===n&&(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-md p-6",children:[(0,t.jsx)("h2",{className:"text-xl font-semibold mb-4",children:w?"Edit Flight":"Add New Flight"}),(0,t.jsxs)("form",{onSubmit:P,className:"space-y-4",children:[(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"flightNumber",className:"block text-sm font-medium mb-1",children:"Flight Number"}),(0,t.jsx)("input",{type:"text",id:"flightNumber",name:"flightNumber",value:x.flightNumber,onChange:e=>u(a=>({...a,flightNumber:e.target.value})),className:"w-full p-2 border rounded-md dark:bg-gray-700 dark:border-gray-600",required:!0})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"airlineId",className:"block text-sm font-medium mb-1",children:"Airline"}),(0,t.jsxs)("select",{id:"airlineId",name:"airlineId",value:x.airlineId,onChange:e=>u(a=>({...a,airlineId:e.target.value})),className:"w-full p-2 border rounded-md dark:bg-gray-700 dark:border-gray-600",required:!0,children:[(0,t.jsx)("option",{value:"",children:"Select an airline"}),h.map(e=>(0,t.jsx)("option",{value:e.id,children:e.name},e.id))]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"origin",className:"block text-sm font-medium mb-1",children:"Origin"}),(0,t.jsx)("input",{type:"text",id:"origin",name:"origin",value:x.origin,onChange:e=>u(a=>({...a,origin:e.target.value})),className:"w-full p-2 border rounded-md dark:bg-gray-700 dark:border-gray-600",required:!0})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"destination",className:"block text-sm font-medium mb-1",children:"Destination"}),(0,t.jsx)("input",{type:"text",id:"destination",name:"destination",value:x.destination,onChange:e=>u(a=>({...a,destination:e.target.value})),className:"w-full p-2 border rounded-md dark:bg-gray-700 dark:border-gray-600",required:!0})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"departureTime",className:"block text-sm font-medium mb-1",children:"Departure Time"}),(0,t.jsx)("input",{type:"datetime-local",id:"departureTime",name:"departureTime",value:x.departureTime,onChange:e=>u(a=>({...a,departureTime:e.target.value})),className:"w-full p-2 border rounded-md dark:bg-gray-700 dark:border-gray-600",required:!0})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"arrivalTime",className:"block text-sm font-medium mb-1",children:"Arrival Time"}),(0,t.jsx)("input",{type:"datetime-local",id:"arrivalTime",name:"arrivalTime",value:x.arrivalTime,onChange:e=>u(a=>({...a,arrivalTime:e.target.value})),className:"w-full p-2 border rounded-md dark:bg-gray-700 dark:border-gray-600",required:!0})]})]}),(0,t.jsxs)("div",{className:"flex space-x-2",children:[(0,t.jsx)("button",{type:"submit",className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors",disabled:y,children:w?"Update Flight":"Add Flight"}),w&&(0,t.jsx)("button",{type:"button",onClick:()=>{T(!1),C(null),u({flightNumber:"",origin:"",destination:"",departureTime:"",arrivalTime:"",airlineId:""})},className:"bg-gray-500 text-white px-4 py-2 rounded-lg hover:bg-gray-600 transition-colors",children:"Cancel"})]})]})]}),(0,t.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-md p-6",children:[(0,t.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Flights List"}),(0,t.jsx)("div",{className:"overflow-x-auto",children:(0,t.jsxs)("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[(0,t.jsx)("thead",{className:"bg-gray-50 dark:bg-gray-700",children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Flight Number"}),(0,t.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Airline"}),(0,t.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Origin"}),(0,t.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Destination"}),(0,t.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Departure"}),(0,t.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Arrival"}),(0,t.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Actions"})]})}),(0,t.jsx)("tbody",{className:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700",children:p.map(e=>(0,t.jsxs)("tr",{children:[(0,t.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:e.flightNumber}),(0,t.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:e.airline.name}),(0,t.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:e.origin}),(0,t.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:e.destination}),(0,t.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:d(e.departureTime)}),(0,t.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:d(e.arrivalTime)}),(0,t.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,t.jsxs)("div",{className:"flex space-x-2",children:[(0,t.jsx)("button",{onClick:()=>{T(!0),C(e.id),u({flightNumber:e.flightNumber,origin:e.origin,destination:e.destination,departureTime:new Date(e.departureTime).toISOString().slice(0,16),arrivalTime:new Date(e.arrivalTime).toISOString().slice(0,16),airlineId:e.airline.id}),o("flights"),window.scrollTo({top:0,behavior:"smooth"})},className:"text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300",children:"Edit"}),(0,t.jsx)("button",{onClick:()=>A({id:e.id,type:"flight"}),className:"text-red-600 hover:text-red-800 dark:text-red-400 dark:hover:text-red-300",children:"Delete"})]})})]},e.id))})]})})]})]}),S&&(0,t.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,t.jsxs)("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-lg shadow-lg max-w-md w-full",children:[(0,t.jsx)("h3",{className:"text-xl font-semibold mb-4",children:"Confirm Delete"}),(0,t.jsxs)("p",{className:"mb-6",children:["Are you sure you want to delete this ",S.type,"? This action cannot be undone."]}),(0,t.jsxs)("div",{className:"flex justify-end space-x-3",children:[(0,t.jsx)("button",{onClick:()=>A(null),className:"px-4 py-2 bg-gray-300 dark:bg-gray-600 rounded-lg hover:bg-gray-400 dark:hover:bg-gray-500 transition-colors",children:"Cancel"}),(0,t.jsx)("button",{onClick:async()=>{f(!0);try{let e=await fetch("/api/".concat(S.type,"s/").concat(S.id),{method:"DELETE"});if(!e.ok){let a=await e.json();throw Error(a.error||"Failed to delete ".concat(S.type))}k("".concat(S.type.charAt(0).toUpperCase()+S.type.slice(1)," deleted successfully")),"airline"===S.type?D():E()}catch(e){N(e instanceof Error?e.message:"Failed to delete ".concat(S.type))}finally{f(!1),A(null)}},className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors",children:"Delete"})]})]})})]})}}},e=>{var a=a=>e(e.s=a);e.O(0,[108,441,684,358],()=>a(5273)),_N_E=e.O()}]);